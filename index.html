<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Entrega de Materiais</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(135deg, #4A3F9E, #6F63BD);
      color: white;
      padding: 20px;
    }
    h1 {
      text-align: center;
    }
    .tabs button {
      padding: 10px 20px;
      margin: 5px;
      background-color: #6F63BD;
      border: none;
      color: white;
      font-weight: bold;
      border-radius: 5px;
      cursor: pointer;
    }
    .aba { display: none; }
    .aba.active { display: block; }
    input, button {
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      border-radius: 5px;
    }
    .carrinho {
      margin-top: 20px;
      background: #fff;
      color: black;
      padding: 10px;
      border-radius: 5px;
    }
    .carrinho-item {
      border-bottom: 1px solid #ccc;
      padding: 5px 0;
    }
  </style>
</head>
<body>
  <h1>Entrega de Materiais</h1>
  <div class="tabs">
    <button onclick="mostrarAba('uso')">Uso Consumo</button>
    <button onclick="mostrarAba('transf')">Transferência</button>
  </div>

  <div id="aba-uso" class="aba active">
    <input type="text" id="transacao" placeholder="Transação">
    <input type="text" id="centro" placeholder="Centro de Custo">
    <input type="text" id="solicitante" placeholder="Solicitante">
    <input type="text" id="responsavel" placeholder="Responsável">
    <input type="text" id="codigo" placeholder="Código">
    <input type="text" id="descricao" placeholder="Descrição">
    <input type="number" id="quantidade" placeholder="Quantidade" min="1" value="1">
    <button onclick="adicionarUso()">Adicionar ao Carrinho</button>
    <div class="carrinho" id="carrinhoUso"></div>
    <button onclick="salvarExcelUso()">Finalizar Entrega</button>
  </div>

  <div id="aba-transf" class="aba">
    <input type="text" id="origem" placeholder="Armazém de Origem">
    <input type="text" id="destino" placeholder="Armazém de Destino">
    <input type="text" id="solicitanteTransf" placeholder="Solicitante">
    <input type="text" id="responsavelTransf" placeholder="Responsável">
    <input type="text" id="codigoTransf" placeholder="Código">
    <input type="text" id="descricaoTransf" placeholder="Descrição">
    <input type="number" id="quantidadeTransf" placeholder="Quantidade" min="1" value="1">
    <button onclick="adicionarTransf()">Adicionar ao Carrinho</button>
    <div class="carrinho" id="carrinhoTransf"></div>
    <button onclick="salvarExcelTransf()">Finalizar Transferência</button>
  </div>

  <script>
    let carrinhoUso = [], carrinhoTransf = [];

    function mostrarAba(aba) {
      document.querySelectorAll('.aba').forEach(div => div.classList.remove('active'));
      document.getElementById('aba-' + aba)?.classList.add('active');
    }

    function adicionarUso() {
      carrinhoUso.push({
        Transacao: document.getElementById('transacao').value,
        Centro: document.getElementById('centro').value,
        Solicitante: document.getElementById('solicitante').value,
        Responsavel: document.getElementById('responsavel').value,
        Codigo: document.getElementById('codigo').value,
        Descricao: document.getElementById('descricao').value,
        Quantidade: document.getElementById('quantidade').value
      });
      renderCarrinho('carrinhoUso', carrinhoUso);
    }

    function adicionarTransf() {
      carrinhoTransf.push({
        Origem: document.getElementById('origem').value,
        Destino: document.getElementById('destino').value,
        Solicitante: document.getElementById('solicitanteTransf').value,
        Responsavel: document.getElementById('responsavelTransf').value,
        Codigo: document.getElementById('codigoTransf').value,
        Descricao: document.getElementById('descricaoTransf').value,
        Quantidade: document.getElementById('quantidadeTransf').value
      });
      renderCarrinho('carrinhoTransf', carrinhoTransf);
    }

    function renderCarrinho(id, dados) {
      const div = document.getElementById(id);
      div.innerHTML = dados.map(item => `<div class="carrinho-item">${Object.values(item).join(' | ')}</div>`).join('');
    }

    function salvarExcelUso() {
      salvarXLSX('UsoConsumo', carrinhoUso);
    }

    function salvarExcelTransf() {
      salvarXLSX('Transferencia', carrinhoTransf);
    }

    function salvarXLSX(nome, dados) {
      const wb = XLSX.utils.book_new();
      const ws = XLSX.utils.json_to_sheet(dados);
      XLSX.utils.book_append_sheet(wb, ws, nome);
      XLSX.writeFile(wb, nome + ".xlsx");
    }
  </script>
</body>
</html>
